
\section{Appendix}
\label{Appendix}
\subsection{Clustering algorithms}
\subsubsection{Deterministic case}
\begin{algorithm}
  \caption{Clustering the steady state deterministic simulation results}
 \begin{algorithmic}[1]
 
    \Statex
        
    \Function{Distance}{$data, delta$}
      \Let{$line\_counter$}{0}
      %\Let{$reach\_end$}{0}
      
      \For{$i$ in($data$)}
      	\If{$line\_counter == 1$}
      		\State Make first cluster
      		%\Let{$clusters\_means$[Cluster 1]}{$i$}
      		%\Let{$clusters\_data$[Cluster 1]}{$i$}
      		\Let{$cluster\_counter$}{$1$}
      	\Else
      		%\For{$cluster$ in $Clusters$}
      		\For{each cluster}
      			\If{ $cluster[x,y] + delta \geq i[x,y] \geq cluster[x,y] - delta$}      			
      					\Let{flag}{True}
      					\State Add to existing cluster \\
      					%\Let{$clusters\_data[cluster]$}{$i$}\\
      					%\Call{Update Means}{$clusters\_means, cluster, i$}
      					\State \Call{Update Means}{cluster means, current data}
      			%\Else
      			%	\Let{$reach\_end$}{$reach\_end + 1$}
      			\EndIf
      			%\If{$reach\_end == length(clusters\_means$) and $flag$ is $False$}
      			\If{reached\_end and $flag$ is $False$}
      				\State $cluster\_counter$ +=  $1$
      				\State Add new cluster
      				%\Let{$clusters\_means$[$cluster\_counter$]}{$i$}
      				%\Let{$clusters\_data$[$cluster\_counter$]}{$i$}
      			\EndIf
      		\EndFor
      	\EndIf
	
      \EndFor
      \State \Return $cluster\_counter$
    \EndFunction
    
    \Statex
    \Function{Update Means}{(clusters\_means, current data)}
    	\Let{$clusters\_means$}{$\frac{clusters\_means + i}{2}$}
    	\State \Return $clusters\_means$
    \EndFunction   
        
  \end{algorithmic}
\end{algorithm}

\subsubsection{Stochastic case}
\begin{algorithm}
\caption{Choosing the optimal number of clusters}
 \begin{algorithmic}[1]
    \Statex
    
    \Function{Wk}{$clusters, cluster\_centres$}
    	\For{each cluster}
    		\For{each point in cluster}
    			\State $a = $ matrix norm $(cluster\_centre - point)$    			
    		\EndFor
    		\State $dk = \sum((a)^2 )\times (2 \times )$ number of points in cluster
    	\EndFor
    	\State $wk = \frac{ \sum(dk)}{2 \times (number of points in cluster)} $
    	\State \Return $wk$
    \EndFunction
    \Statex  
    \Function{bounding\_box}{$data$}
    	\State $xmin, xmax = $ min and max of x axis in data
    	\State $ymin, ymax = $ min and max of y axis in data
    	\State \Return $((xmin, xmax), (ymin, ymax)) $
    \EndFunction
    \Statex
    \Function{Gap\_statistic}{$data, cutoff$}
    	$(xmin, xmax), (ymin, ymax)$ = \Call{bounding\_box}{$data$}%\Comment{variance of data}
    	\State $ks = [1,2,3,4]$\Comment{ number of clusters to try}
    	\For{$k$ in $ks$}
   			\State $cluster_centres, clusters = $ \Call{K\-means}{$data, k, cutoff$}
   			\State $Wk = \log($\Call{Wk}{$clusters, cluster_centres$}$)$
   			
   			\State Create references datasets
   			\For{$i in range(10)$}
   				\For{$n in range ($length of data$)$}
   					\State $Xb = $ random value between $xmin, xmax$ and $ymin, ymax$
   				\EndFor
				\State $cluster_centres, clusters = $ \Call{K\-means}{$data, k, cut-off$}
  				\State $BWk = \log($\Call{Wk}{$clusters, cluster_centres$}$)$
   			\EndFor   
   			\State $Wkb = \frac{\sum(BWk)}{10} $	
   			\State $sk = \sqrt{\sum(\frac{(BWk - Wkb)^2}{10})}$	
   				
    	\EndFor
    	\State $sk = sk \times \sqrt{1=\frac{1}{B}}$
    	\State \Return $ks, Wk, Wkb, sk, data_centres, clusters$
    \EndFunction
    
    \Statex
	\Function{Distance}{$data, cut-off)$}
		    \State $ks, logWks, logWkbs, sk, clusters\_means, clusts = $\Call{gap\_statistic}{$data, cut-off$}
		    \For{$i$ in range $ks$}
		    	\State $gaps = logWks - logWkbs$
		    \EndFor
		    \Let{$cluster\_counter$}{$0$}
		    \For{$i$ in range $gaps$}
		    	\State $cluster\_counter += 1$ 
		    	\If{end}
		    		\Let{$cluster\_counter$}{no clustering}
		    	\EndIf
		    	\If{$gaps[i] \geq (gaps[i+1]-sk[i+1])$}
		    		\State Break \Comment{This is the optimal number of clusters}
		    	\EndIf
		    \EndFor
	\State \Return $cluster\_counter, clusters\_means[cluster_counter]$
	\EndFunction


  \end{algorithmic}
\end{algorithm}

\newpage
\begin{algorithm}
\caption{Clustering stochastic case}
 \begin{algorithmic}[1]
    \Statex
    
    \Function{K\-means clustering}{$data, k, cutoff$}
    	\Statex
    	\Function{Update\_centres}{$old\_centres, values$}
    		\State $centre\_coords = $ mean for each dimension
    		\State $shift = $\Call{getDistance}{$centre\_coords, old\_centres$}
    		\State \Return $shift, centre\_coords$
    	\EndFunction
    
    	\Statex
    	\Function{getDistance}{$a, b$}
    		\State $dist = \sqrt{(a[x] - b[x])^2+(a[y] - b[y])^2}$
    		\State \Return $dist$
    	\EndFunction
      
      	\Statex
      	\While{True}
      		\For{each point in data}
      			\For{each cluster}
      				\State $dist = $\Call{getDistance}{point, cluster centre}
      			\EndFor
      			\State Find cluster with minimum distance
      			\State Repopulate clusters
      		\EndFor
      		
      		\Let{biggest\_shift}{0}
      		\For{as many times as there are clusters}
      			\State $shift$, cluster centres $=$ \Call{Update\_centres}{$old\_centres, clusters$}
      			\State $biggest\_shift = $ max between $shift, biggest\_shift$
      			
      		\EndFor
      		\If{$biggest\_shift \leq cutoff$}
      			\State break
      		\EndIf
      	\EndWhile
      \State \Return $cluster\_centres, clusters$
    \EndFunction

  \end{algorithmic}
\end{algorithm}

