
\section{Clustering algorithms}

\subsection{Deterministic case}
\begin{algorithm}
  \caption{Clustering the steady state deterministic simulation results}
 \begin{algorithmic}[1]
    \Statex
      
      \For{each data point}
      	\If{first point}
      		\State Make first cluster
      		\State cluster counter = 1
      	\Else
      		\For{each cluster}
      			\If{cluster within cluster means $\pm$ delta}      			
      					\State Add to existing cluster \\
      					\State Update means of clusters
      			\EndIf
      			\If{reached\_end and not assigned to cluster}
      				\State cluster counter +=  1
      				\State Add new cluster

      			\EndIf
      		\EndFor
      	\EndIf
	
      \EndFor

        
  \end{algorithmic}
\end{algorithm}

\subsection{Stochastic case}
\subsubsection{Gap statistic}

\begin{algorithm}
\caption{Choosing the optimal number of clusters}
 \begin{algorithmic}[1]
    \Statex
    
    \Function{Wk}{$clusters, cluster\_centres$}
    	\For{each cluster}
    		\For{each point in cluster}
    			\State $a = $ matrix norm $(cluster\_centre - point)$    			
    		\EndFor
    		\State $dk = \sum((a)^2 )\times (2 \times $ number of points in cluster)
    	\EndFor
    	\State $wk = \frac{ \sum(dk)}{2 \times (number of points in cluster)} $
    	\State \Return $wk$
    \EndFunction
    \Statex  
    \Function{bounding\_box}{$data$}
    	\State $xmin, xmax = $ min and max of x axis in data
    	\State $ymin, ymax = $ min and max of y axis in data
    	\State \Return $((xmin, xmax), (ymin, ymax)) $
    \EndFunction
    
    \Statex
    \Function{Gap\_statistic}{$data, cutoff$}
    	\State $(xmin, xmax), (ymin, ymax)$ = \Call{bounding\_box}{$data$}
    	 	\State $ks = [1,2,3,4]$
    	\For{$k$ in $ks$}
   			\State $cluster_centres, clusters = $ \Call{K\-means}{$data, k, cutoff$}
   			\State $Wk = \log($\Call{Wk}{$clusters, cluster_centres$}$)$
   			
   			\State Create references datasets:
   			\For{$i in range(10)$}
   				\For{$n in range ($length of data$)$}
   					\State $Xb = $ random value between $xmin, xmax$ and $ymin, ymax$
   				\EndFor
				\State $cluster_centres, clusters = $ \Call{K\-means}{$data, k, cut-off$}
  				\State $BWk = \log($\Call{Wk}{$clusters, cluster_centres$}$)$
   			\EndFor   
   			\State $Wkb = \frac{\sum(BWk)}{10} $	
   			\State $sk = \sqrt{\sum(\frac{(BWk - Wkb)^2}{10})}$	
   				
    	\EndFor
    	\State $sk = sk \times \sqrt{1=\frac{1}{B}}$
    	\State \Return $ks, Wk, Wkb, sk, data_centres, clusters$
    \EndFunction

    \Statex
	\Function{Distance}{data, cutoff}
		    \State $ks, logWks, logWkbs, sk, clusters\_means, clusts = $\Call{gap\_statistic}{$data, cut-off$}
		    \For{$i$ in range $ks$}
		    	\State $gaps = logWks - logWkbs$
		    \EndFor
		    \Let{$cluster\_counter$}{$0$}
		    \For{$i$ in range $gaps$}
		    	\State $cluster\_counter += 1$ 
		    	\If{end}
		    		no clustering
		    	\EndIf
		    	\If{$gaps[i] \geq (gaps[i+1]-sk[i+1])$}
		    		\State Break 
		    	\EndIf
		    \EndFor
	\State \Return $cluster\_counter, clusters\_means[cluster_counter]$
	\EndFunction


  \end{algorithmic}
\end{algorithm}

\subsubsection{K-means clustering}
\newpage
\begin{algorithm}
\caption{Clustering stochastic case}
 \begin{algorithmic}[1]
    \Statex
    
    \Function{K\-means clustering}{$data, k, cutoff$}
    	\Statex
    	\Function{Update\_centres}{$old\_centres, values$}
    		\State $centre\_coords = $ mean for each dimension
    		\State $shift = $\Call{getDistance}{$centre\_coords, old\_centres$}
    		\State \Return $shift, centre\_coords$
    	\EndFunction
    
    	\Statex
    	\Function{getDistance}{$a, b$}
    		\State $dist = \sqrt{(a[x] - b[x])^2+(a[y] - b[y])^2}$
    		\State \Return $dist$
    	\EndFunction
      
      	\Statex
      	\While{True}
      		\For{each point in data}
      			\For{each cluster}
      				\State $dist = $\Call{getDistance}{point, cluster centre}
      			\EndFor
      			\State Find cluster with minimum distance
      			\State Repopulate clusters
      		\EndFor
      		
      		\Let{biggest\_shift}{0}
      		\For{as many times as there are clusters}
      			\State $shift$, cluster centres $=$ \Call{Update\_centres}{$old\_centres, clusters$}
      			\State $biggest\_shift = $ max between $shift, biggest\_shift$
      			
      		\EndFor
      		\If{$biggest\_shift \leq cutoff$}
      			\State break
      		\EndIf
      	\EndWhile
      \State \Return $cluster\_centres, clusters$
    \EndFunction

  \end{algorithmic}
\end{algorithm}

